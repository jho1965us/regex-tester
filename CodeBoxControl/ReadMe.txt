Based on: http://www.codeproject.com/Articles/35413/CodeBox-2-An-Extended-and-Improved-Version-of-the

Modified to allow highlighting of zero width text and end of line
